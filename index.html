<!DOCTYPE html>
<html>

<head>
    <style>
    #open{
        display:none;
        width:95vw;
        height:95vh;
        background-color: red;
        border-color: red;
        font-size: 50;
    }
    .wrapper{
        text-align: center;
    }
    .button{
        position: absolute;
        top: 50%;
    }
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/sha256.js"></script>
</head>

<body>
<script>

function saveyThing() {
    var password = document.getElementById("pass");
    localStorage.setItem("password", password.value);
    localStorage.setItem("set", true);
    showButton();
}

function showPasswordForm() {
    document.getElementById("passwordform").style.display="inline";
    document.getElementById("open").style.display="none";
    document.getElementById("return").style.display="none";
    localStorage.setItem("set", false);
}

function showButton() {
    document.getElementById("passwordform").style.display="none";
    document.getElementById("open").style.display="inline";
    document.getElementById("return").style.display="inline";
}

function openDoor() {
    console.log(localStorage.getItem("password"));
}

$(document).ready(function(){
    $("#open").click(function()
    {
        console.log("got here");

        $.post("http://10.13.37.40", {key: 0}, function(data, status)
        {
            if (status == "success")
            {
                console.log("It worked!");
                console.log("Doing super advanced cryptographyâ€¦");
                passkey = CryptoJS.SHA1(key);
                $.post("https://10.13.37.40", {key: passkey.value}, function(data, status){
                        console.log(status);
                });
            }
        });
    });
});

</script>

<form id="passwordform">
Password: <input type="password" name="pwd" id="pass"><br>
<input type="text" style="display:none;">
<input type="button" value="Submit" onclick="saveyThing()">
</form>

<div class="wrapper">
<button id="open">Alohomora!</button>
<button id="return" style="display:none;" onclick="showPasswordForm()">Re-enter password</button>
</div>

<script>
console.log(localStorage.getItem("set"));
if(localStorage.getItem("set") != "null" && localStorage.getItem("set") != "false")
{
    showButton();
}
else
{
    showPasswordForm();
}
</script>
</body>
</html>